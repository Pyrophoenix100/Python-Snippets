name: Update Include.js on Site
on:
  push:
    paths:
      - 'JavaScript/include.js' # Path to the file you want to track for syncronization
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
        - name: Checkout repository
          uses: actions/checkout@v2
        - name: Get SHA of File
          uses: actions/github-script@v4
          with:
            script: |
              const fs = require('fs')
              const response = await github.repos.getContent({
                owner: 'pyrophoenix100',
                repo: 'pyrophoenix100.github.io',
                path: 'scripts/include.js'
              });
              console.log(response.data.sha);
              core.warning(response.data.sha);
              fs.appendFileSync(process.env.GITHUB_STATE, 'sha=' + response.data.sha + '${os.EOL}', {
                encoding: 'utf8'
              })
        - name: Overwrite include.js
          uses: actions/github-script@v4
          with:
            script: |
              const fs = require('fs')
              const path = require('path')
              const content = fs.readFileSync('./JavaScript/include.js', 'utf8')
              github.repos.createOrUpdateFileContents({
                owner: 'Pyrophoenix100',
                repo: 'pyrophoenix100.github.io',
                path: 'scripts/include.js',
                message: 'Update include.js',
                content: Buffer.from(content).toString('base64'),
                sha: ${{ env.SHA }}
              })
            github-token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}
